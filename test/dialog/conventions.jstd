travi.test.testCase('dialog conventions', (function () {
    'use strict';

    var conventions = travi.ui.dialog.conventions,
        dialog = travi.ui.dialog.simple,

        url = 'someUrl';

    return {
        setUp: function () {
            $('body').append('<a href="' + url + '" class="dialog-target"></a>');

            sinon.stub(dialog, 'loadFromUrl');
        },

        tearDown: function () {
            travi.test.common.restore([
                dialog.loadFromUrl
            ]);
        },


        'test that clicking on a link with the dialog-target class loads dialog from href': function () {
            conventions.init();

            $('a.dialog-target').click();

            sinon.assert.calledOnce(dialog.loadFromUrl);
        }
    };
}()));