!function(a){"use strict";function b(a){d.subscribe(e.LOADED,a)}function c(a){a.success&&d.subscribe(e.FORM_SUCCESS,a.success),a.created&&d.subscribe(e.FORM_RESULT_CREATED,a.created)}var d=a.events,e={LOADED:"dialog-loaded",RESIZED:"dialog-resized",FORM_SUCCESS:"dialog-form-success",FORM_RESULT_CREATED:"dialog-form-result-created"};a.register("ui.dialog.events",{keys:e,load:b,form:c})}(travi),function(a){"use strict";function b(){f&&f.dialog("close")}function c(){f.dialog("option","position",{my:"center",at:"center",of:window})}function d(a){f=$(a.html),$("body").append(f),f.dialog({title:a.title,modal:!0,width:"auto",close:function(){$(this).dialog("destroy").remove(),f=null}}),f.on("click",".actions a.cancel",function(a){a.preventDefault(),b()})}function e(a){$.ajax({url:a.url,dataType:"html",type:"get",success:function(b){d({html:b,title:a.title}),g.publish(h.keys.LOADED,{dialog:f.get(0)})}})}var f,g=a.events,h=a.ui.dialog.events;a.register("ui.dialog.core",{loadFromUrl:e,recenter:c,close:b})}(travi),function(a){"use strict";function b(){c.load(function(){d.init()})}var c=a.ui.dialog.events,d=a.ui.form.buttons;a.register("ui.dialog.buttons",{init:b})}(travi),function(a){"use strict";function b(a){var b=$(a.target).closest("a");a.preventDefault(),g.loadFromUrl({url:b.attr("href"),title:b.text()})}function c(){f.subscribe(a.ui.dialog.events.keys.RESIZED,function(){g.recenter()})}function d(){$("body").on("click","a.dialog-target",b)}function e(){d(),c()}var f=a.events,g=a.ui.dialog.core;a.register("ui.dialog.conventions",{init:e})}(travi),function(a){"use strict";function b(){c.load(d.init)}var c=a.ui.dialog.events,d=a.ui.form.date;a.register("ui.dialog.date",{init:b})}(travi),function(a){"use strict";function b(a){return JSON.parse(a.responseText).form.errors}function c(a){var c=$(this);a.preventDefault(),$.ajax({url:c.attr("action"),type:c.attr("method")||"get",dataType:"json",data:c.serialize(),statusCode:{201:function(a,b,c){f.publish(h.keys.FORM_RESULT_CREATED,{resource:c.getResponseHeader("Location")})},400:function(a){i.showErrors(c.get(0),b(a))}},success:function(a){g.close(),f.publish(h.keys.FORM_SUCCESS,{resource:a.resource,key:c.attr("travi-form-key")})}})}function d(a){$(a.dialog).find("form").submit(c)}function e(){f.subscribe(h.keys.LOADED,d)}var f=a.events,g=a.ui.dialog.core,h=a.ui.dialog.events,i=a.ui.form.validationMapper;a.register("ui.dialog.form",{init:e})}(travi),function(a){"use strict";function b(){d.load(function(){e.init(),c.publish(d.keys.RESIZED)})}var c=a.events,d=a.ui.dialog.events,e=a.ui.form.richText;a.register("ui.dialog.richText",{init:b})}(travi);
//# sourceMappingURL=dialog.min.js.map